<!DOCTYPE html>
<html lang="en">
  <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
  </head>

  <body>

    <div class="container">
      <div class="row d-flex justify-content-center">
          <h3 class="w-auto p-3">Set widget parameters (if necessary)</h3>
      </div>

      <div class="row block start">
        <div class="col-sm">
            <label class="form-label">uxMode:</label>
            <div class="form-check  form-switch"  onclick="checkUxMode()">
              <input class="form-check-input" type="checkbox" role="switch" id="uxModeSwitch">
              <label id="uxModeSwitch-lable" class="form-check-label" for="uxModeSwitch">panels</label>
            </div>

            <label class="form-label mt-3">widgetType:</label>
            <div class="form-check">
              <input class="form-check-input" type="radio" name="widgetTypeRadio" id="widgetTypeEvent" value="event" checked>
              <label class="form-check-label" for="widgetTypeEvent">event</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="radio" name="widgetTypeRadio" id="widgetTypeList" value="list">
              <label class="form-check-label" for="widgetTypeList">list</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="radio" name="widgetTypeRadio" id="widgetTypeCalendar" value="calendar">
              <label class="form-check-label" for="widgetTypeCalendar">calendar</label>
            </div>

            <div class="row align-items-center">
              <label for="inputEventId" class="col-form-label">eventId:</label>
              <div class="col-sm">
                <input type="text" id="inputEventId" class="form-control">
              </div>
              <div class="col-sm">
                <div class="form-check  form-switch"  onclick="checkEventId()">
                  <input class="form-check-input" type="checkbox" role="switch" id="eventIdSwitch" checked>
                  <label id="eventIdSwitch-lable" class="form-check-label" for="eventIdSwitch">enable</label>
                </div>
              </div>
            </div>

            <div class="row align-items-center">
              <label for="inputOrganizerId" class="col-form-label">organizerId:</label>
              <div class="col-sm">
                <input type="text" id="inputOrganizerId" class="form-control">
              </div>
              <div class="col-sm">
                <div class="form-check  form-switch"  onclick="checkOrganizerId()">
                  <input class="form-check-input" type="checkbox" role="switch" id="organizerIdSwitch" checked>
                  <label id="organizerIdSwitch-lable" class="form-check-label" for="organizerIdSwitch">enable</label>
                </div>
              </div>
            </div>

            <label class="form-label mt-3">eventBlocks:</label>
            <div class="form-check">
              <input class="form-check-input" type="checkbox" name="eventBlocks" id="eventBlocksHero" data-i="0" value="hero" checked>
              <label class="form-check-label" for="eventBlocksHero">hero</label>
            </div>

            <div class="form-check">
              <input class="form-check-input" type="checkbox" name="eventBlocks" id="eventBlocksOverviewDetails" data-i="1" value="overview-details" checked>
              <label class="form-check-label" for="eventBlocksOverviewDetails">overview-details</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="checkbox" name="eventBlocks" id="eventBlocksOverviewDescription" data-i="2" value="overview-description" checked>
              <label class="form-check-label" for="eventBlocksOverviewDescription">overview-details</label>
            </div>

            <div class="form-check">
              <input class="form-check-input" type="checkbox" name="eventBlocks" id="eventBlocksPricing" data-i="3" value="pricing" checked>
              <label class="form-check-label" for="eventBlocksPricing">pricing</label>
            </div>

        </div>

        <div class="col-3"></div>
        <div class="col-sm">
            <div class="form-check form-switch">
              <input class="form-check-input" type="checkbox" role="switch" id="modalScrollSwitch" onclick="checkScroll()" checked>
              <label id="modalScrollSwitch-label" class="form-check-label" for="modalScrollSwitch">Modal scroll is visible.</label>
            </div>
        </div>

      </div>

      <div class="row d-flex justify-content-center p-4">
        <button id="showWidget" type="button" class="btn btn-primary w-auto p-2" onclick="showWidget()">Show Widget</button>
      </div>

        <div class="row d-flex justify-content-center">
          <script id="purplepass">
            Purplepass = {
              organizerId: '55069',
              eventId: '229425',
              eventBlocks: ['hero', 'overview-details', 'overview-description', 'pricing'],
              showHidden: 'true',
              containerStyles: {
                maxWidth: '1150px',
                border: '1px solid rgb(215 219 235)',
              },
            }
         </script>
        </div>
        <div class="row d-flex justify-content-center p-4 end">
          <div class="col-sm">
            <div id="end-block" class="blockend "></div>
          </div>
        </div>
    </div>
    <style>
      .block {
        box-sizing: border-box;
        padding: 30px;
        font-size: 16px;
      }
      .start {
        background: #f8d1d1;
      }
      .end {
        background: #e7f791;
        font-size: 24px;
      }
      .form-check-label {
        padding-left: 20px;
      }
    </style>

    <script>
      const userAgent = window.navigator.userAgent.toLowerCase();
      const isSafari = /constructor/i.test(window.HTMLElement) || (function (p) { return p.toString() === "[object SafariRemoteNotification]"; })(!window['safari'] || (typeof safari !== 'undefined' && window['safari'].pushNotification));
      const isMacLike = /(Mac|iPhone|iPod|iPad)/i.test(window.navigator.platform);
      const isIos = /iphone|ipod|ipad/.test( userAgent );
      const isApple = isSafari || isIos || isMacLike;
      const endEl = document.getElementById('end-block');
      if (isApple) {
        endEl.innerHTML = 'It is Apple';
      } else {
        endEl.innerHTML = 'It is not Apple';
      }


      function checkUxMode() {
        const checkBox = document.getElementById('uxModeSwitch');
        const label = document.getElementById('uxModeSwitch-lable');
        if (checkBox.checked === true){
          label.innerHTML = 'embedded';
          checkBox.setAttribute('checked', 'checked')
          Purplepass = {
            ...Purplepass,
            uxMode: 'embedded',
          }
        } else {
          label.innerHTML = 'panels';
          checkBox.removeAttribute('checked');
          Purplepass = {
            ...Purplepass,
            uxMode: 'panels',
          }
        }
      }

      function checkScroll() {
        const checkBox = document.getElementById('modalScrollSwitch');
        const label = document.getElementById('modalScrollSwitch-label');
        if (checkBox.checked === true){
          label.innerHTML = 'Modal scroll is visible.';
          checkBox.setAttribute('checked', 'checked')
          Purplepass = {
            ...Purplepass,
            isModalScroll: true,
          }
        } else {
          label.innerHTML = 'Modal scroll is invisible.';
          checkBox.removeAttribute('checked');
          Purplepass = {
            ...Purplepass,
            isModalScroll: false,
          }
        }
      }

      const radios = document.getElementsByName('widgetTypeRadio');
      for (let i = 0; i < radios.length; i++) {
          radios[i].addEventListener('change', function() {
              for (let el of radios) {
                  el.removeAttribute('checked');
              }
              this.setAttribute('checked', 'checked')
              Purplepass = {
                ...Purplepass,
                widgetType: this.value,
              }
          });
      }

      const inputEventIdEl = document.getElementById('inputEventId');
      inputEventIdEl.value = Purplepass.eventId;
      inputEventIdEl.setAttribute('value', `${Purplepass.eventId}`);
      inputEventIdEl.addEventListener('input', inputEventIdHandler);

      function inputEventIdHandler(e) {
        //console.log('value', e.target.value)
        Purplepass = {
          ...Purplepass,
          eventId: `${e.target.value}`,
        }
        inputEventIdEl.setAttribute('value', `${e.target.value}`);

      }

      const inputOrganizerIdEl = document.getElementById('inputOrganizerId');
      inputOrganizerIdEl.value = Purplepass.organizerId;
      inputOrganizerIdEl.setAttribute('value', `${Purplepass.organizerId}`);
      inputOrganizerIdEl.addEventListener('input', inputEventOrganizerIdHandler);

      function inputEventOrganizerIdHandler(e) {
        console.log('value', e.target.value)
        Purplepass = {
          ...Purplepass,
          organizerId: `${e.target.value}`,
        }
        inputOrganizerIdEl.setAttribute('value', `${e.target.value}`);
      }


      function checkEventId() {
        const checkBox = document.getElementById('eventIdSwitch');
        const label = document.getElementById('eventIdSwitch-lable');
        if (checkBox.checked === true){
          label.innerHTML = 'enable';
          checkBox.setAttribute('checked', 'checked')
        } else {
          label.innerHTML = 'disable';
          checkBox.removeAttribute('checked');
          Purplepass = {
            ...Purplepass,
            eventId: '',
          }
          inputEventIdEl.setAttribute('value', '');
          inputEventIdEl.value = '';
        }
      }

      function checkOrganizerId() {
        const checkBox = document.getElementById('organizerIdSwitch');
        const label = document.getElementById('organizerIdSwitch-lable');
        if (checkBox.checked === true){
          label.innerHTML = 'enable';
          checkBox.setAttribute('checked', 'checked')
        } else {
          label.innerHTML = 'disable';
          checkBox.removeAttribute('checked');
          Purplepass = {
            ...Purplepass,
            organizerId: '',
          }
          inputOrganizerIdEl.setAttribute('value', '');
          inputOrganizerIdEl.value = '';
        }
      }

      const eventBlocks = document.getElementsByName('eventBlocks');
      for (let i = 0; i < eventBlocks.length; i++) {
        eventBlocks[i].addEventListener('change', function() {
          const i = this.dataset.i;
          const newEventBlocks = [...Purplepass.eventBlocks];
          if (this.checked === true){

            this.setAttribute('checked', 'checked')

            newEventBlocks[i] = this.value;
            Purplepass = {
              ...Purplepass,
              eventBlocks: newEventBlocks,
            }
          } else {
            this.removeAttribute('checked');
            newEventBlocks[i] = '';
            Purplepass = {
              ...Purplepass,
              eventBlocks: newEventBlocks,
            }
          }

        });
      }

      function showWidget() {
        console.log('Purplepass', Purplepass);
        const button = document.getElementById('showWidget');
        button.innerHTML = 'Refresh the page if you want to change the settings again';
        button.disabled = true;

        const scr = document.createElement('script');
        scr.setAttribute('id', 'ppass-script');
        scr.setAttribute('src', 'https://devpp.purplepass.com/assets/widget/widget-full.js');
        document.body.appendChild(scr);
      }
   </script>
  </body>
</html>
